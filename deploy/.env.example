# external-dns-docker environment variable configuration
# Copy this file to .env and fill in your values.
# CLI flags take precedence over environment variables.

# ----- RFC2136 DNS Server (required) -----

# Hostname or IP of the RFC2136-capable DNS server (e.g. BIND9, PowerDNS)
EXTERNAL_DNS_RFC2136_HOST=ns1.example.com

# DNS server port (default: 53)
EXTERNAL_DNS_RFC2136_PORT=53

# Zone to manage — include the trailing dot
EXTERNAL_DNS_RFC2136_ZONE=example.com.

# TSIG key name as configured on the DNS server
EXTERNAL_DNS_RFC2136_TSIG_KEY=external-dns-docker

# TSIG secret: provide either the inline base64 value OR a path to a file,
# never both. Prefer the file form for production deployments.
#EXTERNAL_DNS_RFC2136_TSIG_SECRET=YOUR_BASE64_SECRET_HERE
EXTERNAL_DNS_RFC2136_TSIG_SECRET_FILE=/run/secrets/tsig_secret

# TSIG algorithm — hmac-sha256 (default), hmac-sha512, hmac-sha1
EXTERNAL_DNS_RFC2136_TSIG_ALG=hmac-sha256

# Minimum TTL enforced on all records (0 = disabled)
EXTERNAL_DNS_RFC2136_MIN_TTL=0

# Timeout for RFC2136 DNS operations: AXFR zone transfer and UPDATE messages
EXTERNAL_DNS_RFC2136_TIMEOUT=10s

# ----- Docker Source -----

# Docker daemon address. Leave unset for the default Unix socket.
#EXTERNAL_DNS_DOCKER_HOST=unix:///var/run/docker.sock

# TLS client credentials for remote Docker daemons (optional)
#EXTERNAL_DNS_DOCKER_TLS_CA=/certs/ca.pem
#EXTERNAL_DNS_DOCKER_TLS_CERT=/certs/cert.pem
#EXTERNAL_DNS_DOCKER_TLS_KEY=/certs/key.pem

# ----- Controller -----

# How often to run a full reconciliation even without Docker events (default: 60s)
EXTERNAL_DNS_INTERVAL=60s

# Quiet period after a Docker event before reconciling (default: 5s)
EXTERNAL_DNS_DEBOUNCE=5s

# Run exactly one reconciliation cycle and exit (default: false)
EXTERNAL_DNS_ONCE=false

# Log planned changes without applying them (default: false)
EXTERNAL_DNS_DRY_RUN=false

# Ownership identifier written into TXT sidecar records (default: external-dns-docker)
EXTERNAL_DNS_OWNER_ID=external-dns-docker

# Skip the startup SOA connectivity check (default: false)
EXTERNAL_DNS_SKIP_PREFLIGHT=false

# Exponential backoff base and cap for consecutive reconciliation failures
EXTERNAL_DNS_RECONCILE_BACKOFF_BASE=5s
EXTERNAL_DNS_RECONCILE_BACKOFF_MAX=5m

# ----- Health / Metrics -----

# Port for /healthz, /readyz, and /metrics (0 = disabled, default: 8080)
EXTERNAL_DNS_HEALTH_PORT=8080

# HTTP path for the Prometheus metrics endpoint (default: /metrics)
EXTERNAL_DNS_METRICS_PATH=/metrics

# ----- Shutdown -----

# Maximum time to wait for graceful shutdown after SIGTERM (default: 30s)
EXTERNAL_DNS_SHUTDOWN_TIMEOUT=30s

# ----- Logging -----

# Log level: debug, info, warn, error (default: info)
EXTERNAL_DNS_LOG_LEVEL=info
